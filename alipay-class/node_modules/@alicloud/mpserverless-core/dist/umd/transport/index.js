"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const tslib_1 = require("tslib");
const constant_1 = require("../constant");
const codec_1 = require("../codec");
class HTTPTransport {
    constructor(endpoint) {
        this.endpoint = endpoint;
        this.protocol = constant_1.TransportProtocol.HTTP;
    }
    getEncoder(prefix) {
        return new codec_1.HTTPRequestEncoder(this.endpoint, prefix);
    }
    setAppId(appId) {
        this.appId = appId;
    }
    setAppSecret(privateKey) {
        this.appSecret = privateKey;
        return this;
    }
    setUA(ua) {
        this.ua = ua;
        return this;
    }
    setLogger(logger) {
        this.logger = logger;
    }
    setTimeout(timeout = '5s') {
        if (typeof timeout === 'string') {
            if (timeout.indexOf('ms') >= 0) {
                this.timeout = parseInt(timeout, 10);
                return;
            }
            if (timeout.indexOf('s') >= 0) {
                this.timeout = parseInt(timeout, 10) * 1000;
                return;
            }
        }
        else if (typeof timeout === 'number') {
            this.timeout = timeout;
            return;
        }
        this.timeout = 5000;
    }
    get timeoutOption() {
        return this.timeout;
    }
    setSpaceId(spaceId) {
        this.spaceId = spaceId;
    }
    request(encoder) {
        return tslib_1.__awaiter(this, void 0, void 0, function* () {
            return (new codec_1.HTTPResponseDecoder()).decode();
        });
    }
}
exports.HTTPTransport = HTTPTransport;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvdHJhbnNwb3J0L2luZGV4LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUFBLDBDQUF3RDtBQUV4RCxvQ0FJa0I7QUFFbEIsTUFBYSxhQUFhO0lBVXhCLFlBQ1MsUUFBZ0I7UUFBaEIsYUFBUSxHQUFSLFFBQVEsQ0FBUTtRQVRsQixhQUFRLEdBQXNCLDRCQUFpQixDQUFDLElBQUksQ0FBQztJQVV6RCxDQUFDO0lBTUcsVUFBVSxDQUFDLE1BQWU7UUFFL0IsT0FBTyxJQUFJLDBCQUFrQixDQUFDLElBQUksQ0FBQyxRQUFRLEVBQUUsTUFBTSxDQUFDLENBQUM7SUFDdkQsQ0FBQztJQU9NLFFBQVEsQ0FBQyxLQUFhO1FBQzNCLElBQUksQ0FBQyxLQUFLLEdBQUcsS0FBSyxDQUFDO0lBQ3JCLENBQUM7SUFPTSxZQUFZLENBQUMsVUFBa0I7UUFDcEMsSUFBSSxDQUFDLFNBQVMsR0FBRyxVQUFVLENBQUM7UUFDNUIsT0FBTyxJQUFJLENBQUM7SUFDZCxDQUFDO0lBT00sS0FBSyxDQUFDLEVBQVU7UUFDckIsSUFBSSxDQUFDLEVBQUUsR0FBRyxFQUFFLENBQUM7UUFDYixPQUFPLElBQUksQ0FBQztJQUNkLENBQUM7SUFPTSxTQUFTLENBQUMsTUFBYztRQUM3QixJQUFJLENBQUMsTUFBTSxHQUFHLE1BQU0sQ0FBQztJQUN2QixDQUFDO0lBT00sVUFBVSxDQUFDLFVBQXlCLElBQUk7UUFDN0MsSUFBSSxPQUFPLE9BQU8sS0FBSyxRQUFRLEVBQUU7WUFDL0IsSUFBSSxPQUFPLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsRUFBRTtnQkFDOUIsSUFBSSxDQUFDLE9BQU8sR0FBRyxRQUFRLENBQUMsT0FBTyxFQUFFLEVBQUUsQ0FBQyxDQUFDO2dCQUNyQyxPQUFPO2FBQ1I7WUFDRCxJQUFJLE9BQU8sQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxFQUFFO2dCQUM3QixJQUFJLENBQUMsT0FBTyxHQUFHLFFBQVEsQ0FBQyxPQUFPLEVBQUUsRUFBRSxDQUFDLEdBQUcsSUFBSSxDQUFDO2dCQUM1QyxPQUFPO2FBQ1I7U0FDRjthQUFNLElBQUksT0FBTyxPQUFPLEtBQUssUUFBUSxFQUFFO1lBQ3RDLElBQUksQ0FBQyxPQUFPLEdBQUcsT0FBTyxDQUFDO1lBQ3ZCLE9BQU87U0FDUjtRQUdELElBQUksQ0FBQyxPQUFPLEdBQUcsSUFBSSxDQUFDO0lBQ3RCLENBQUM7SUFLRCxJQUFXLGFBQWE7UUFDdEIsT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDO0lBQ3RCLENBQUM7SUFPTSxVQUFVLENBQUMsT0FBZTtRQUMvQixJQUFJLENBQUMsT0FBTyxHQUFHLE9BQU8sQ0FBQztJQUN6QixDQUFDO0lBT1ksT0FBTyxDQUNsQixPQUEyQjs7WUFFM0IsT0FBTyxDQUFDLElBQUksMkJBQW1CLEVBQUUsQ0FBQyxDQUFDLE1BQU0sRUFBRSxDQUFDO1FBQzlDLENBQUM7S0FBQTtDQUNGO0FBL0dELHNDQStHQyJ9