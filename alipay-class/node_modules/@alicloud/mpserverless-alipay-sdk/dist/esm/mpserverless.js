import { MPServerlessMiniAppCore, } from '@alicloud/mpserverless-miniapp-core';
export class MPServerless extends MPServerlessMiniAppCore {
    constructor(options) {
        super({
            request: (args) => {
                return this.wrap(my.request)(args);
            },
            getAuthCode: (args) => {
                return this.wrap(my.getAuthCode)(args);
            },
            uploadFile: (args) => {
                return this.wrap(my.uploadFile)(args);
            },
            getFileUploadInfo: (options) => {
                let fileSize = 0;
                let fileExtension = '';
                return this.wrap(my.getFileInfo)({
                    apFilePath: options.filePath,
                }).then(fileInfoRes => {
                    if (fileInfoRes.size) {
                        fileSize = fileInfoRes.size;
                    }
                    return this.wrap(my.getImageInfo)({
                        src: options.filePath,
                    });
                }).then(imageInfoRes => {
                    if (imageInfoRes.type) {
                        fileExtension = imageInfoRes.type;
                    }
                    return {
                        fileSize,
                        fileExtension,
                    };
                });
            },
        }, options);
    }
    wrap(myMethod) {
        return args => {
            return new Promise(resolve => {
                myMethod(Object.assign(args, {
                    complete: (res = {}) => {
                        return resolve(res);
                    },
                }));
            });
        };
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibXBzZXJ2ZXJsZXNzLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL21wc2VydmVybGVzcy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQ0wsdUJBQXVCLEdBQ3hCLE1BQU0scUNBQXFDLENBQUM7QUFFN0MsTUFBTSxPQUFPLFlBQWEsU0FBUSx1QkFBdUI7SUFDdkQsWUFBWSxPQUFZO1FBQ3RCLEtBQUssQ0FBQztZQUNKLE9BQU8sRUFBRSxDQUFDLElBQVMsRUFBZ0IsRUFBRTtnQkFDbkMsT0FBTyxJQUFJLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUNyQyxDQUFDO1lBQ0QsV0FBVyxFQUFFLENBQUMsSUFBUyxFQUFnQixFQUFFO2dCQUN2QyxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLFdBQVcsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQ3pDLENBQUM7WUFDRCxVQUFVLEVBQUUsQ0FBQyxJQUFTLEVBQWdCLEVBQUU7Z0JBQ3RDLE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsVUFBVSxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDeEMsQ0FBQztZQUNELGlCQUFpQixFQUFFLENBQUMsT0FBWSxFQUFnQixFQUFFO2dCQUNoRCxJQUFJLFFBQVEsR0FBRyxDQUFDLENBQUM7Z0JBQ2pCLElBQUksYUFBYSxHQUFHLEVBQUUsQ0FBQztnQkFFdkIsT0FBTyxJQUFJLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxXQUFXLENBQUMsQ0FBQztvQkFDL0IsVUFBVSxFQUFFLE9BQU8sQ0FBQyxRQUFRO2lCQUM3QixDQUFDLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxFQUFFO29CQUNwQixJQUFJLFdBQVcsQ0FBQyxJQUFJLEVBQUU7d0JBQ3BCLFFBQVEsR0FBRyxXQUFXLENBQUMsSUFBSSxDQUFDO3FCQUM3QjtvQkFFRCxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLFlBQVksQ0FBQyxDQUFDO3dCQUNoQyxHQUFHLEVBQUUsT0FBTyxDQUFDLFFBQVE7cUJBQ3RCLENBQUMsQ0FBQztnQkFDTCxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDLEVBQUU7b0JBQ3JCLElBQUksWUFBWSxDQUFDLElBQUksRUFBRTt3QkFDckIsYUFBYSxHQUFHLFlBQVksQ0FBQyxJQUFJLENBQUM7cUJBQ25DO29CQUVELE9BQU87d0JBQ0wsUUFBUTt3QkFDUixhQUFhO3FCQUNkLENBQUM7Z0JBQ0osQ0FBQyxDQUFDLENBQUM7WUFDTCxDQUFDO1NBQ0YsRUFBRSxPQUFPLENBQUMsQ0FBQztJQUNkLENBQUM7SUFNTSxJQUFJLENBQUMsUUFBUTtRQUNsQixPQUFPLElBQUksQ0FBQyxFQUFFO1lBQ1osT0FBTyxJQUFJLE9BQU8sQ0FBTSxPQUFPLENBQUMsRUFBRTtnQkFDaEMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsSUFBSSxFQUFFO29CQUMzQixRQUFRLEVBQUUsQ0FBQyxNQUFXLEVBQUUsRUFBRSxFQUFFO3dCQUMxQixPQUFPLE9BQU8sQ0FBQyxHQUFHLENBQUMsQ0FBQztvQkFDdEIsQ0FBQztpQkFDRixDQUFDLENBQUMsQ0FBQztZQUNOLENBQUMsQ0FBQyxDQUFDO1FBQ0wsQ0FBQyxDQUFDO0lBQ0osQ0FBQztDQUNGIn0=